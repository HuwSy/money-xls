<!DOCTYPE html>
<html>

<head>
  <title>Money</title>
  <meta content="text/html;charset=utf-8"
        http-equiv="Content-Type">
  <meta content="utf-8"
        http-equiv="encoding">
  <meta name="viewport"
        content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <meta name="apple-mobile-web-app-capable"
        content="yes">
  <link rel="icon"
        type="image/x-icon"
        href="./favicon.ico">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.17.0/dist/xlsx.full.min.js"
          type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx-calc@0.9.2/xlsx-calc.min.js"
          type="text/javascript"></script>
  <link rel="stylesheet"
        href="./styles.css">
  <script type="text/javascript"
          src="./scripts.js"></script>
</head>

<body>
  <div>
    <p>All files are processed directly within your own browser and never online, view the code <a href="https://github.com/HuwSy/money-xls">here</a></p>

    <div id="top">
      Start:
      <input style="width:80px"
             type="date"
             onchange="StartChange(this.value)"
             id="start"
             name="start"
             placeholder="Override start date">
      Today:
      <input style="width:80px"
             type="date"
             onchange="TodayChange(this.value)"
             id="today"
             name="today"
             placeholder="Override todays date">
      <input type="file"
             style="display:none;"
             id="File"
             name="file"
             onchange="FileChange(this)">
      <input id="Upload"
             name="upload"
             onclick="Upload()"
             type="button"
             value="Load"
             style="float: right">
      <br style="clear:both;">
    </div>

    <div class="tabs">
      <div id="future"
           style="display:none">
        <input checked
               type="radio"
               id="r1"
               style="display:none"
               name="sheet">
        <label onclick="HideUnhide(this.previousElementSibling)"
               for="r1">Spending</label>
        <div>
          <table id="upcoming">
            <tr></tr>
          </table>

          <table id="spending">
            <tr>
              <td onclick="Search()">
                <input name="cc"
                       type="checkbox"
                       title="CC expense">
              </td>
              <td onclick="Search()">
                <input name="date"
                       type="date"
                       style="width: 60px;"
                       required>
              </td>
              <td onclick="Search()">
                <input name="amount"
                       type="number"
                       step="0.01"
                       size="10"
                       style="width: 50px"
                       required>
              </td>
              <td>
                <input name="activity"
                       type="text"
                       placeholder="Activity"
                       autocomplete="on"
                       style="width: 70px"
                       required
                       onkeyup="Search(this)"
                       onclick="Search()">
                <ul></ul>
              </td>
              <td onclick="Search()">
                <input name="add"
                       type="button"
                       value="+"
                       onclick="NewRow(this.parentNode.parentNode, true)">
              </td>
              <td onclick="Search()">
                <input name="remove"
                       type="button"
                       value="-"
                       onclick="DelRow(this.parentNode.parentNode, true)">
              </td>
            </tr>
          </table>
          <input name="include"
                 style="float:right"
                 type="button"
                 value="Inc."
                 onclick="Search();IncludeSpent()">
          <br style="clear:both;">

          <textarea id="D3"
                    name="d3"
                    style="width:95%"
                    rows="3"></textarea>
          <br>
          
          <input id="Cc"
                 name="cc"
                 type="number"
                 style="width: 75px"
                 disabled>
          <input id="E3"
                 name="e3"
                 type="number"
                 step="0.01"
                 style="width: 75px">
          <input id="Sum"
                 name="sum"
                 type="number"
                 style="width: 75px"
                 disabled>
          CC c/p/t
          <br>
          
          <input id="D1"
                 name="D1"
                 type="number"
                 step="0.01"
                 style="width:75px;">
          <input id="D2"
                 name="d2"
                 type="number"
                 style="width: 75px"
                 disabled>
          <input id="Tbd"
                 name="tbd"
                 type="number"
                 style="width: 75px"
                 disabled>
          Acc s/c
          <br>
  
          <input name="update"
                 style="float:right"
                 type="button"
                 value="Upd."
                 onclick="UpdateCC()">
          <br style="clear:both;">

          <select id="range"
                  onchange="Filter()"
                  style="width: 30%;">
          </select>
          <select id="cols"
                  onchange="Filter()"
                  style="width: 30%;">
          </select>
          <input id="filter"
                 onkeyup="Filter()"
                 style="width: 30%;">

          <table id="spent">
          </table>
        </div>
      </div>
      <div id="over"
           style="display:none">
        <input type="radio"
               id="r6"
               style="display:none"
               name="sheet">
        <label onclick="HideUnhide(this.previousElementSibling)"
               for="r6">Futures</label>
        <div>
          <table>
          </table>
        </div>
      </div>
      <div id="options"
           style="display:none">
        <input type="radio"
               id="r5"
               style="display:none"
               name="sheet">
        <label onclick="HideUnhide(this.previousElementSibling)"
               for="r5">Tasks</label>
        <div>
          <table id="plans"
                 style="display:none">
            <caption>
              <select onchange="SortPlan(this.value)"
                      name="SortPlan">
                <option selected></option>
                <option value="-1">Repeat</option>
                <option value="4">Start</option>
                <option value="3">End</option>
                <option value="5">Value</option>
                <option value="6">Name</option>
                <option value="7">FNo</option>
                <option value="-2">Annualy</option>
              </select>
            </caption>
            <tr>
              <td>
                <input name="year"
                       type="number"
                       style="width:34px"
                       placeholder="Years">
              </td>
              <td>
                <input name="month"
                       type="number"
                       style="width:38px"
                       placeholder="Months">
              </td>
              <td>
                <input name="day"
                       type="number"
                       style="width:38px"
                       placeholder="Days">
              </td>
              <td>
                <input name="end"
                       type="date"
                       style="width:96px"
                       placeholder="End">
              </td>
              <td>
                <input name="start"
                       type="date"
                       style="width:96px"
                       placeholder="Start"
                       required>
              </td>
              <td>
                <input name="cost"
                       type="number"
                       style="width:56px"><input type="button"
                       value="T"
                       onclick="ToggleType(this.previousElementSibling)"
                       required>
              </td>
              <td>
                <input name="title"
                       type="text"
                       style="width:120px"
                       required>
              </td>
              <td>
                <input name="f"
                       type="number"
                       style="width:34px"
                       placeholder="FNumber">
              </td>
              <td>
                <input name="new"
                       type="button"
                       value="+"
                       onclick="NewRow(this.parentNode.parentNode)">
              </td>
              <td>
                <input name="rem"
                       type="button"
                       value="-"
                       onclick="DelRow(this.parentNode.parentNode)">
              </td>
            </tr>
          </table>
          <input type="button"
                 value="Plan"
                 onclick="PopulatePlan(this)"
                 style="display:initial;">
          <input type="button"
                 value="Save"
                 onclick="SavePlan(this)"
                 style="display:none">
          <input type="button"
                 value="Cancel"
                 onclick="Cancel(this)"
                 style="display:none">
          <br><br>

          <div id="formulas"
                 style="display:none;width:100%">
            <div>
              <span>
                <input name="col"
                       type="text"
                       style="width:25px"
                       placeholder="Col"
                       disabled>
              </span>
              <span>
                <input name="heading"
                       type="text"
                       style="width:175px"
                       placeholder="Col heading">
              </span>
              <span style="display: block;">
                <textarea name="total"
                          style="width:100%"
                          rows="8"
                          placeholder="Total"></textarea>
              </span>
              <span style="display: block;">
                <textarea name="formula"
                          style="width:100%"
                          rows="8"
                          placeholder="Formula"></textarea>
              </span>
            </div>
          </div>
          <input type="button"
                 value="F1:Z2"
                 onclick="PopulateFormulas(this)"
                 style="display:initial;">
          <input type="button"
                 value="Save"
                 onclick="SaveFormulas(this)"
                 style="display:none">
          <input type="button"
                 value="Cancel"
                 onclick="Cancel(this)"
                 style="display:none">
          <br><br>
          
          <input type="button"
                 onclick="RunAll()"
                 value="Run All">
          <input type="button"
                 onclick="Saving()"
                 value="Save"
                 style="margin-left: 8px;">
        </div>
      </div>
      <div id="log">
        <input type="radio"
               id="r9"
               style="display:none"
               name="sheet">
        <label onclick="HideUnhide(this.previousElementSibling)"
               for="r9">Log</label>
        <div>
          <div id="output">
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
